(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{kUBF:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i("fXoL"),c=i("ofXK"),o=i("TEn/");function a(t,e){if(1&t&&(n.Pb(0,"span",8),n.Lb(1,"ion-icon",9),n.Pb(2,"span",6),n.pc(3),n.ac(4,"date"),n.Ob(),n.Ob()),2&t){const t=n.Zb();n.Ab(3),n.qc(n.bc(4,1,t.date))}}function s(t,e){if(1&t&&(n.Nb(0),n.pc(1),n.ac(2,"date"),n.Mb()),2&t){const t=n.Zb();n.Ab(1),n.rc(" - ",n.cc(2,1,t.untilTime,"shortTime")," ")}}const l=function(t){return{"margin-left":t}};let r=(()=>{class t{constructor(){this.clicked=new n.n}onItemClicked(t){this.clicked.emit(null)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Eb({type:t,selectors:[["action-item-card"]],inputs:{headerText:"headerText",fromTime:"fromTime",untilTime:"untilTime",date:"date",bgCss:"bgCss"},outputs:{clicked:"clicked"},decls:11,vars:11,consts:[[1,"item-container",3,"ngClass","click"],[1,"header-text"],[1,"flex-row"],["class","icon-text-container","style","margin-left: 10px",4,"ngIf"],[1,"icon-text-container",3,"ngStyle"],["name","time-outline"],[1,"secondary-text"],[4,"ngIf"],[1,"icon-text-container",2,"margin-left","10px"],["name","calendar-outline"]],template:function(t,e){1&t&&(n.Pb(0,"div",0),n.Xb("click",(function(t){return e.onItemClicked(t)})),n.Pb(1,"span",1),n.pc(2),n.Ob(),n.Pb(3,"div",2),n.nc(4,a,5,3,"span",3),n.Pb(5,"span",4),n.Lb(6,"ion-icon",5),n.Pb(7,"span",6),n.pc(8),n.ac(9,"date"),n.nc(10,s,3,4,"ng-container",7),n.Ob(),n.Ob(),n.Ob(),n.Ob()),2&t&&(n.fc("ngClass",e.bgCss),n.Ab(2),n.qc(e.headerText),n.Ab(2),n.fc("ngIf",null!=e.date),n.Ab(1),n.fc("ngStyle",n.hc(9,l,null!=e.date?"8%":"10px")),n.Ab(3),n.rc(" ",n.cc(9,6,e.fromTime,"shortTime")," "),n.Ab(2),n.fc("ngIf",e.untilTime))},directives:[c.i,c.k,c.l,o.s],pipes:[c.d],styles:[".item-container[_ngcontent-%COMP%]{height:50px;width:95%;border-radius:7px;display:flex;flex-direction:column;justify-content:space-evenly}.item-container[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]{margin-left:10px;font-size:1.2em}"]}),t})()},nLfy:function(t,e,i){"use strict";i.r(e),i.d(e,"SchedulePageModule",(function(){return Y}));var n=i("ofXK"),c=i("3Pt+"),o=i("tyNb"),a=i("TEn/"),s=i("mrSG"),l=i("H7h6"),r=i("ShvM"),b=i("64sz"),d=i("PZfV"),g=i("fXoL"),h=i("2g2N"),f=i("F4Db"),u=i("xgIS"),m=i("wO+i");const p=["imageInput"];function A(t,e){if(1&t&&(g.Pb(0,"ion-title"),g.pc(1),g.Ob()),2&t){const t=g.Zb();g.Ab(1),g.qc(t.actionEditable.action.name)}}function D(t,e){1&t&&(g.Nb(0),g.Lb(1,"ion-icon",22),g.Mb())}function P(t,e){1&t&&(g.Nb(0),g.pc(1," None "),g.Mb())}function O(t,e){if(1&t&&(g.Pb(0,"ion-item",8),g.Pb(1,"ion-label"),g.pc(2,"Started"),g.Ob(),g.pc(3),g.ac(4,"date"),g.Ob()),2&t){const t=g.Zb(2);g.Ab(3),g.rc(" ",g.cc(4,1,t.actionEditable.actionStartedDateTime,"shortTime")," ")}}function C(t,e){if(1&t&&(g.Pb(0,"ion-item",8),g.Pb(1,"ion-label"),g.pc(2,"Finished"),g.Ob(),g.pc(3),g.ac(4,"date"),g.Ob()),2&t){const t=g.Zb(2);g.Ab(3),g.rc(" ",g.cc(4,1,t.actionEditable.actionFinishedDateTime,"shortTime")," ")}}function v(t,e){1&t&&(g.Nb(0),g.pc(1," Add picture "),g.Mb())}function T(t,e){1&t&&(g.Nb(0),g.pc(1," Change picture "),g.Mb())}function I(t,e){if(1&t&&g.Lb(0,"img",23),2&t){const t=g.Zb(2);g.fc("src",t.actionEditable.photo.pictureUri,g.lc)}}const k=function(t){return{completed:t}},y=function(t){return{canceled:t}};function x(t,e){if(1&t){const t=g.Qb();g.Pb(0,"ion-item-group"),g.Pb(1,"ion-item-divider",7),g.Pb(2,"h4"),g.pc(3,"General action description"),g.Ob(),g.Ob(),g.Pb(4,"ion-item",8),g.pc(5),g.Ob(),g.Pb(6,"ion-item-divider",9),g.Pb(7,"h4"),g.pc(8," Specific action info"),g.Ob(),g.nc(9,D,2,0,"ng-container",0),g.Ob(),g.Pb(10,"ion-item",8),g.Pb(11,"ion-label"),g.Pb(12,"h5"),g.pc(13,"Description"),g.Ob(),g.Pb(14,"p",10),g.nc(15,P,2,0,"ng-container",0),g.pc(16),g.Ob(),g.Ob(),g.Ob(),g.Pb(17,"ion-item",8),g.Pb(18,"ion-label"),g.pc(19,"Day"),g.Ob(),g.pc(20),g.Ob(),g.Pb(21,"ion-item",8),g.Pb(22,"ion-label"),g.pc(23,"Planned start time"),g.Ob(),g.pc(24),g.ac(25,"date"),g.Ob(),g.Pb(26,"ion-item",8),g.Pb(27,"ion-label"),g.pc(28,"Estimated duration"),g.Ob(),g.pc(29),g.Ob(),g.nc(30,O,5,4,"ion-item",11),g.nc(31,C,5,4,"ion-item",11),g.Pb(32,"ion-item",12),g.Pb(33,"ion-label"),g.pc(34,"Canceled"),g.Ob(),g.Pb(35,"ion-toggle",13),g.Xb("ngModelChange",(function(e){return g.kc(t),g.Zb().actionEditable.isCanceled=e}))("ionChange",(function(e){return g.kc(t),g.Zb().cancledChanged(e)})),g.Ob(),g.Ob(),g.Pb(36,"ion-item",8),g.Pb(37,"ion-label",14),g.pc(38,"Comment"),g.Ob(),g.Pb(39,"ion-textarea",15),g.Xb("ngModelChange",(function(e){return g.kc(t),g.Zb().actionEditable.comment=e})),g.Ob(),g.Ob(),g.Pb(40,"ion-item",3),g.Pb(41,"input",16,17),g.Xb("change",(function(e){return g.kc(t),g.Zb().processFile(e)})),g.Ob(),g.Pb(43,"ion-button",18),g.Xb("click",(function(){return g.kc(t),g.Zb().addPicture()})),g.Lb(44,"ion-icon",19),g.nc(45,v,2,0,"ng-container",0),g.nc(46,T,2,0,"ng-container",0),g.Ob(),g.Ob(),g.Pb(47,"div",20),g.nc(48,I,1,1,"img",21),g.Ob(),g.Ob()}if(2&t){const t=g.Zb();g.Ab(5),g.rc(" ",t.actionEditable.action.generalDescription," "),g.Ab(1),g.fc("ngClass",g.hc(20,k,t.actionEditable.isCompleted)),g.Ab(3),g.fc("ngIf",t.actionEditable.isCompleted),g.Ab(6),g.fc("ngIf",null==t.actionEditable.clientActionSpecificDescription),g.Ab(1),g.rc(" ",t.actionEditable.clientActionSpecificDescription," "),g.Ab(4),g.rc(" ",t.generalHelper.getDayNameByIndex(t.actionEditable.day)," "),g.Ab(4),g.rc(" ",g.cc(25,17,t.actionEditable.plannedStartDateTime,"shortTime")," "),g.Ab(5),g.rc(" ",t.actionEditable.estimatedDurationMinutes," min "),g.Ab(1),g.fc("ngIf",t.actionEditable.actionStartedDateTime),g.Ab(1),g.fc("ngIf",t.actionEditable.actionFinishedDateTime),g.Ab(1),g.fc("ngClass",g.hc(22,y,t.actionEditable.isCanceled)),g.Ab(3),g.fc("ngModel",t.actionEditable.isCanceled)("disabled",t.actionEditable.isCompleted),g.Ab(4),g.fc("ngModel",t.actionEditable.comment),g.Ab(6),g.fc("ngIf",!t.actionEditable.photo.pictureUri),g.Ab(1),g.fc("ngIf",t.actionEditable.photo.pictureUri),g.Ab(2),g.fc("ngIf",t.actionEditable.photo.pictureUri)}}function E(t,e){if(1&t){const t=g.Qb();g.Pb(0,"ion-button",24),g.Xb("click",(function(){return g.kc(t),g.Zb().startAction()})),g.pc(1," Start action "),g.Ob()}}function M(t,e){if(1&t){const t=g.Qb();g.Pb(0,"ion-button",25),g.Xb("click",(function(){return g.kc(t),g.Zb().stopAction()})),g.pc(1," Stop action "),g.Ob()}}function S(t,e){if(1&t&&(g.Nb(0),g.pc(1),g.Mb()),2&t){const t=g.Zb();g.Ab(1),g.rc(" ",t.time," ")}}let w=(()=>{class t{constructor(t,e,i,n,c,o){this.modalController=t,this.registeredActionsService=e,this.toaster=i,this.imageHelper=n,this.generalHelper=c,this.platform=o,this.time="00:00.000",this.started=null}ngOnInit(){this.actionEditable=this.mapActionToEditable()}updateAction(){return Object(s.a)(this,void 0,void 0,(function*(){try{let t=yield this.registeredActionsService.apiRegisteredActionsRegisteredActionPut(this.actionEditable);null!=t&&(this.action=t,this.actionEditable=this.mapActionToEditable(),this.toaster.showSuccessToast("Successfully saved"))}catch(t){this.toaster.showErrorToast("Opration failed. Try it again")}}))}closeModal(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.modalController.dismiss()}))}startAction(){this.actionEditable.actionStartedDateTime=new Date,this.startTimer(),this.updateAction()}stopAction(){this.actionEditable.actionFinishedDateTime=new Date,this.isTimerVisible=!1,clearInterval(this.started),this.updateAction()}addPicture(){return Object(s.a)(this,void 0,void 0,(function*(){if(!1===this.platform.is("capacitor"))return void this.imageInput.nativeElement.click();let t=yield this.imageHelper.getImageAsBase64FromDevice();null!=t&&(this.actionEditable.photo.pictureUri=t)}))}processFile(t){let e=t.target.files,i=e[0];if(e&&i){let t=new FileReader;this.imageToBase64(t,i).subscribe(t=>{null!=t&&(this.actionEditable.photo.pictureUri=t)})}}imageToBase64(t,e){return t.readAsDataURL(e),Object(u.a)(t,"load").pipe(Object(m.a)("currentTarget","result"))}mapActionToEditable(){let t={id:this.action.id,action:this.action.action,actionFinishedDateTime:this.action.actionFinishedDateTime,actionStartedDateTime:this.action.actionStartedDateTime,clientActionSpecificDescription:this.action.clientActionSpecificDescription,comment:this.action.comment,estimatedDurationMinutes:this.action.estimatedDurationMinutes,isCanceled:this.action.isCanceled,isCompleted:this.action.isCompleted,photo:this.action.photo,plannedStartDateTime:this.action.plannedStartDateTime,day:this.action.day};return!1===t.isCompleted&&!1===t.isCanceled&&null!=t.actionStartedDateTime&&this.startTimer(),t}cancledChanged(t){t&&t.detail&&t.detail.checked&&!this.actionEditable.comment&&this.toaster.showInfoToast("Please enter reason why is action cancled to comment section.")}startTimer(){this.started=setInterval(this.clockRunning.bind(this),10),this.isTimerVisible=!0}clockRunning(){let t=this.actionEditable.actionStartedDateTime,e=new Date,i=new Date(e-t),n=i.getUTCHours(),c=i.getUTCMinutes(),o=i.getUTCSeconds(),a=i.getUTCMilliseconds();this.time=this.zeroPrefix(n,2)+":"+this.zeroPrefix(c,2)+":"+this.zeroPrefix(o,2)+"."+this.zeroPrefix(a,3)}zeroPrefix(t,e){let i="";for(let n=0;n<e;n++)i+="0";return(i+t).slice(-e)}}return t.\u0275fac=function(e){return new(e||t)(g.Kb(a.P),g.Kb(l.e),g.Kb(h.a),g.Kb(f.a),g.Kb(b.a),g.Kb(a.R))},t.\u0275cmp=g.Eb({type:t,selectors:[["app-client-action-detail"]],viewQuery:function(t,e){var i;1&t&&g.tc(p,!0),2&t&&g.ic(i=g.Yb())&&(e.imageInput=i.first)},inputs:{action:"action"},decls:14,vars:6,consts:[[4,"ngIf"],["slot","end","fill","clear",3,"click"],["slot","icon-only","name","close"],["lines","none"],["slot","start","color","success",3,"click",4,"ngIf"],["slot","start","color","dark",3,"click",4,"ngIf"],["slot","end","color","primary",3,"disabled","click"],[1,"item-separator"],["lines","full","mode","md"],[1,"item-separator",3,"ngClass"],[2,"white-space","pre-wrap"],["lines","full","mode","md",4,"ngIf"],["lines","full","mode","md",3,"ngClass"],[3,"ngModel","disabled","ngModelChange","ionChange"],["position","floating"],["clearInput","","rows","5","autoGrow","",2,"min-height","100px",3,"ngModel","ngModelChange"],["type","file","hidden","","accept","image/*",3,"change"],["imageInput",""],["fill","clear","slot","end",3,"click"],["name","camera","slot","icon-only"],[2,"display","flex","justify-content","center"],["style","max-width: 70%;",3,"src",4,"ngIf"],["name","checkmark-circle-outline","slot","end"],[2,"max-width","70%",3,"src"],["slot","start","color","success",3,"click"],["slot","start","color","dark",3,"click"]],template:function(t,e){1&t&&(g.Pb(0,"ion-header"),g.Pb(1,"ion-toolbar"),g.nc(2,A,2,1,"ion-title",0),g.Pb(3,"ion-button",1),g.Xb("click",(function(){return e.closeModal()})),g.Lb(4,"ion-icon",2),g.Ob(),g.Ob(),g.Ob(),g.Pb(5,"ion-content"),g.nc(6,x,49,24,"ion-item-group",0),g.Ob(),g.Pb(7,"ion-footer"),g.Pb(8,"ion-item",3),g.nc(9,E,2,0,"ion-button",4),g.nc(10,M,2,0,"ion-button",5),g.nc(11,S,2,1,"ng-container",0),g.Pb(12,"ion-button",6),g.Xb("click",(function(){return e.updateAction()})),g.pc(13,"Save "),g.Ob(),g.Ob(),g.Ob()),2&t&&(g.Ab(2),g.fc("ngIf",e.actionEditable),g.Ab(4),g.fc("ngIf",e.actionEditable),g.Ab(3),g.fc("ngIf",!e.actionEditable.actionStartedDateTime),g.Ab(1),g.fc("ngIf",e.actionEditable.actionStartedDateTime&&!e.actionEditable.actionFinishedDateTime),g.Ab(1),g.fc("ngIf",e.isTimerVisible),g.Ab(1),g.fc("disabled",e.actionEditable.isCanceled&&null==e.actionEditable.comment))},directives:[a.r,a.L,n.k,a.i,a.s,a.n,a.p,a.w,a.J,a.y,a.x,n.i,a.z,a.K,a.c,c.c,c.d,a.I,a.V],pipes:[n.d],styles:[""]}),t})();var Z=i("kUBF");function F(t,e){if(1&t){const t=g.Qb();g.Pb(0,"action-item-card",11),g.Xb("clicked",(function(){g.kc(t);const e=g.Zb().$implicit;return g.Zb(2).openDetailModal(e.id)})),g.Ob()}if(2&t){const t=g.Zb().$implicit,e=g.Zb(2);g.fc("headerText",t.action.name)("fromTime",t.plannedStartDateTime)("bgCss",e.visualHelper.getBgCssColorForRegisteredAction(t))}}function X(t,e){if(1&t&&(g.Pb(0,"div",9),g.nc(1,F,1,3,"action-item-card",10),g.Ob()),2&t){const t=e.index,i=g.Zb(2);g.Ab(1),g.fc("ngIf",t<3||i.allItemsVisible)}}function B(t,e){if(1&t){const t=g.Qb();g.Pb(0,"ion-button",12),g.Xb("click",(function(){return g.kc(t),g.Zb(2).showMore()})),g.pc(1,"Show more"),g.Ob()}}function L(t,e){if(1&t){const t=g.Qb();g.Pb(0,"ion-button",12),g.Xb("click",(function(){return g.kc(t),g.Zb(2).showLess()})),g.pc(1," Show less"),g.Ob()}}function N(t,e){if(1&t&&(g.Pb(0,"ion-card"),g.Pb(1,"div",1),g.Pb(2,"ion-avatar",2),g.Lb(3,"img",3),g.Ob(),g.Pb(4,"h3",4),g.pc(5),g.Ob(),g.Ob(),g.Pb(6,"div",5),g.nc(7,X,2,1,"div",6),g.Ob(),g.Pb(8,"div",7),g.nc(9,B,2,0,"ion-button",8),g.nc(10,L,2,0,"ion-button",8),g.Ob(),g.Ob()),2&t){const t=g.Zb();g.Ab(3),g.fc("src",t.client.profilePicture,g.lc),g.Ab(2),g.rc(" ",t.client.fullName," "),g.Ab(2),g.fc("ngForOf",t.clientActions.registeredActions),g.Ab(2),g.fc("ngIf",t.clientActions.registeredActions.length>3&&!1===t.allItemsVisible),g.Ab(1),g.fc("ngIf",t.clientActions.registeredActions.length>3&&t.allItemsVisible)}}let K=(()=>{class t{constructor(t,e,i,n){this.clientCache=t,this.modalController=e,this.visualHelper=i,this.clientsService=n,this.detailModalClosed=new g.n,this.allItemsVisible=!1}ngOnInit(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.clientCache.loaded;let t=this.clientActions.clientId;if(this.client=this.clientCache.getClientById(t),null==this.client){let e=yield this.clientsService.apiClientsSingleClientGet(t),i=yield this.clientCache.mapDtoToClient(e);this.client=i}}))}calculateEstimatedEndTime(t,e){return new Date(t.getTime()+6e4*e)}openDetailModal(t){return Object(s.a)(this,void 0,void 0,(function*(){let e=this.clientActions.registeredActions.find(e=>e.id===t),i=yield this.modalController.create({component:w,componentProps:{action:e}});yield i.present(),i.onDidDismiss().then(()=>this.detailModalClosed.emit())}))}showMore(){this.allItemsVisible=!0}showLess(){this.allItemsVisible=!1}}return t.\u0275fac=function(e){return new(e||t)(g.Kb(r.a),g.Kb(a.P),g.Kb(d.a),g.Kb(l.b))},t.\u0275cmp=g.Eb({type:t,selectors:[["client-actions-overview"]],inputs:{clientActions:"clientActions"},outputs:{detailModalClosed:"detailModalClosed"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"flex-row"],["slot","start",2,"margin","10px"],[3,"src"],[1,"client-name-header"],[1,"flex-column",2,"align-items","flex-end"],["class","action-item-small ",4,"ngFor","ngForOf"],[1,"flex-center"],["fill","clear",3,"click",4,"ngIf"],[1,"action-item-small"],[3,"headerText","fromTime","bgCss","clicked",4,"ngIf"],[3,"headerText","fromTime","bgCss","clicked"],["fill","clear",3,"click"]],template:function(t,e){1&t&&g.nc(0,N,11,5,"ion-card",0),2&t&&g.fc("ngIf",e.clientActions&&e.client)},directives:[n.k,a.k,a.e,n.j,Z.a,a.i],styles:[".client-name-header[_ngcontent-%COMP%]{margin-left:10px;padding-top:10px}"]}),t})();function j(t,e){if(1&t){const t=g.Qb();g.Pb(0,"ion-datetime",9,10),g.Xb("ngModelChange",(function(e){return g.kc(t),g.Zb().selectedDate=e}))("ionChange",(function(e){return g.kc(t),g.Zb().selectedDateChange(e)})),g.Ob()}if(2&t){const t=g.Zb();g.gc("min",t.ionDateTimeConsumableMinDate),g.gc("max",t.ionDateTimeConsumableMaxDate),g.fc("ngModel",t.selectedDate)}}function H(t,e){1&t&&(g.Pb(0,"p",11),g.pc(1,"No registered actions"),g.Ob())}function z(t,e){1&t&&(g.Nb(0),g.pc(1," (today) "),g.Mb())}function R(t,e){if(1&t){const t=g.Qb();g.Pb(0,"ion-col",15),g.Pb(1,"client-actions-overview",16),g.Xb("detailModalClosed",(function(){return g.kc(t),g.Zb(2).reloadData()})),g.Ob(),g.Ob()}if(2&t){const t=e.$implicit,i=g.Zb(2);g.fc("size",i.visualHelper.getBasicDataGridSize()),g.Ab(1),g.fc("clientActions",t)}}function U(t,e){if(1&t&&(g.Nb(0),g.Pb(1,"ion-item-divider",12),g.Pb(2,"ion-label"),g.pc(3),g.ac(4,"date"),g.nc(5,z,2,0,"ng-container",13),g.Ob(),g.Ob(),g.Pb(6,"ion-grid"),g.Pb(7,"ion-row"),g.nc(8,R,2,2,"ion-col",14),g.Ob(),g.Ob(),g.Mb()),2&t){const t=e.$implicit,i=g.Zb();g.Ab(3),g.rc(" ",g.bc(4,3,t.date)," "),g.Ab(2),g.fc("ngIf",i.isToday(t.date)),g.Ab(3),g.fc("ngForOf",t.registeredActionsClient)}}function Q(t,e){if(1&t){const t=g.Qb();g.Pb(0,"ion-infinite-scroll",17),g.Xb("ionInfinite",(function(e){return g.kc(t),g.Zb().loadMoreData(e)})),g.Lb(1,"ion-infinite-scroll-content",18),g.Ob()}}let V=(()=>{class t{constructor(t,e,i,n){this.registeredActionsService=t,this.clientsCache=e,this.generalHelper=i,this.visualHelper=n,this.isPreviousBtnEnabled=!0,this.isNextBtnEnabled=!0,this.selectedDate=(new Date).toISOString()}ngOnInit(){this.reloadData()}reloadData(){return Object(s.a)(this,void 0,void 0,(function*(){this.registeredActionsService.apiRegisteredActionsLastRegisteredActionsMinMaxDateGet().then(t=>{this.minDate=t.minDate,this.maxDate=t.maxDate,this.ionDateTimeConsumableMinDate=this.convertDateToIonDateTimeConsumableString(this.minDate),this.ionDateTimeConsumableMaxDate=this.convertDateToIonDateTimeConsumableString(this.maxDate)}),yield this.clientsCache.loaded;let t=10;this.registeredActions&&0===this.registeredActions.length&&(t=this.registeredActions.length),this.registeredActions=null;let e=new Date(this.selectedDate),i=yield this.registeredActionsService.apiRegisteredActionsRegisteredActionsGet(t,e,null);this.registeredActions=i,console.log(i)}))}isToday(t){let e=new Date;return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}loadMoreData(t){let e=this.registeredActions[this.registeredActions.length-1].date,i=this.registeredActions[this.registeredActions.length-1].registeredActionsClient,n=i[i.length-1].registeredActions,c=n[n.length-1],o=new Date(this.selectedDate);this.registeredActionsService.apiRegisteredActionsRegisteredActionsGet(10,o,c.id).then(n=>{this.generalHelper.compareDatesWithoutTime(e,n[0].date)&&i[i.length-1].clientId===n[0].registeredActionsClient[0].clientId&&(n=this.mergeData(n)),this.registeredActions=this.registeredActions.concat(n),t.target.disabled=this.registeredActions[this.registeredActions.length-1].containsLast}).finally(()=>t.target.complete())}mergeData(t){let e=this.registeredActions[this.registeredActions.length-1].registeredActionsClient;return this.registeredActions[this.registeredActions.length-1].registeredActionsClient[this.registeredActions[this.registeredActions.length-1].registeredActionsClient.length-1].registeredActions=e[e.length-1].registeredActions.concat(t[0].registeredActionsClient[0].registeredActions),t[0].registeredActionsClient.splice(0,1),0===t[0].registeredActionsClient.length&&t.splice(0,1),t}previousDayClicked(){let t=new Date(this.selectedDate);t.setDate(t.getDate()-1),this.selectedDate=t.toISOString(),this.reloadData(),this.setPreviousDayBtnEnablity(t)}nextDayClicked(){let t=new Date(this.selectedDate);t.setDate(t.getDate()+1),this.selectedDate=t.toISOString(),this.reloadData(),this.setNextDayBtnEnablity(t)}setNextDayBtnEnablity(t){let e=new Date(this.maxDate);this.isNextBtnEnabled=!(t.setDate(t.getDate())>e.setHours(0,0,0,0))}setPreviousDayBtnEnablity(t){let e=new Date(this.minDate);this.isPreviousBtnEnabled=!(t.setDate(t.getDate())<e.setHours(0,0,0,0))}openDatePicker(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.datePicker.open()}))}selectedDateChange(t){if(t&&t.detail&&t.detail.value){this.selectedDate=new Date(t.detail.value).toISOString(),this.reloadData();let e=new Date(this.selectedDate);this.setNextDayBtnEnablity(e),this.setPreviousDayBtnEnablity(e)}}convertDateToIonDateTimeConsumableString(t){let e=t.getFullYear().toString(),i=(t.getMonth()+1).toString(),n=t.getDate().toString();return t.getMonth()+1<10&&(i=`0${i}`),t.getDate()<10&&(n=`0${n}`),`${e}-${i}-${n}`}}return t.\u0275fac=function(e){return new(e||t)(g.Kb(l.e),g.Kb(r.a),g.Kb(b.a),g.Kb(d.a))},t.\u0275cmp=g.Eb({type:t,selectors:[["app-schedule"]],viewQuery:function(t,e){var i;1&t&&g.tc(a.o,!0),2&t&&g.ic(i=g.Yb())&&(e.datePicker=i.first)},decls:18,vars:9,consts:[[1,"flex-center"],["slot","icon-only","fill","clear",3,"disabled","click"],["name","arrow-back"],[1,"flex-align-center",2,"font-size","1.2em",3,"click"],["hidden","",3,"ngModel","min","max","ngModelChange","ionChange",4,"ngIf"],["name","arrow-forward"],["style","text-align: center;",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"ionInfinite",4,"ngIf"],["hidden","",3,"ngModel","min","max","ngModelChange","ionChange"],["datePicker",""],[2,"text-align","center"],[1,"item-separator"],[4,"ngIf"],[3,"size",4,"ngFor","ngForOf"],[3,"size"],[3,"clientActions","detailModalClosed"],[3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Loading more data..."]],template:function(t,e){1&t&&(g.Pb(0,"ion-header"),g.Pb(1,"ion-toolbar"),g.Pb(2,"ion-title"),g.pc(3,"Schedule"),g.Ob(),g.Ob(),g.Pb(4,"ion-toolbar"),g.Pb(5,"div",0),g.Pb(6,"ion-button",1),g.Xb("click",(function(){return e.previousDayClicked()})),g.Lb(7,"ion-icon",2),g.Ob(),g.Pb(8,"div",3),g.Xb("click",(function(){return e.openDatePicker()})),g.pc(9),g.ac(10,"date"),g.nc(11,j,2,3,"ion-datetime",4),g.Ob(),g.Pb(12,"ion-button",1),g.Xb("click",(function(){return e.nextDayClicked()})),g.Lb(13,"ion-icon",5),g.Ob(),g.Ob(),g.Ob(),g.Ob(),g.Pb(14,"ion-content"),g.nc(15,H,2,0,"p",6),g.nc(16,U,9,5,"ng-container",7),g.nc(17,Q,2,0,"ion-infinite-scroll",8),g.Ob()),2&t&&(g.Ab(6),g.fc("disabled",!e.isPreviousBtnEnabled),g.Ab(3),g.rc(" ",g.bc(10,7,e.selectedDate)," "),g.Ab(2),g.fc("ngIf",e.ionDateTimeConsumableMinDate&&e.ionDateTimeConsumableMaxDate),g.Ab(1),g.fc("disabled",!e.isNextBtnEnabled),g.Ab(3),g.fc("ngIf",e.registeredActions&&0==e.registeredActions.length),g.Ab(1),g.fc("ngForOf",e.registeredActions),g.Ab(1),g.fc("ngIf",e.registeredActions))},directives:[a.r,a.L,a.J,a.i,a.s,n.k,a.n,n.j,a.o,a.U,c.c,c.d,a.x,a.z,a.q,a.D,a.m,K,a.t,a.u],pipes:[n.d],styles:[""]}),t})();var $=i("hcQm");const G=[{path:"",component:V}];let Y=(()=>{class t{}return t.\u0275mod=g.Ib({type:t}),t.\u0275inj=g.Hb({factory:function(e){return new(e||t)},imports:[[n.b,c.a,a.M,$.a,o.j.forChild(G)]]}),t})()}}]);