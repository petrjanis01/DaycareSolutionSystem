function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{kUBF:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("fXoL"),c=i("ofXK"),a=i("TEn/");function o(e,t){if(1&e&&(n.Pb(0,"span",8),n.Lb(1,"ion-icon",9),n.Pb(2,"span",6),n.pc(3),n.ac(4,"date"),n.Ob(),n.Ob()),2&e){var i=n.Zb();n.Ab(3),n.qc(n.bc(4,1,i.date))}}function r(e,t){if(1&e&&(n.Nb(0),n.pc(1),n.ac(2,"date"),n.Mb()),2&e){var i=n.Zb();n.Ab(1),n.rc(" - ",n.cc(2,1,i.untilTime,"shortTime")," ")}}var s=function(e){return{"margin-left":e}},l=function(){var e=function(){function e(){_classCallCheck(this,e),this.clicked=new n.n}return _createClass(e,[{key:"onItemClicked",value:function(e){this.clicked.emit(null)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Eb({type:e,selectors:[["action-item-card"]],inputs:{headerText:"headerText",fromTime:"fromTime",untilTime:"untilTime",date:"date",bgCss:"bgCss"},outputs:{clicked:"clicked"},decls:11,vars:11,consts:[[1,"item-container",3,"ngClass","click"],[1,"header-text"],[1,"flex-row"],["class","icon-text-container","style","margin-left: 10px",4,"ngIf"],[1,"icon-text-container",3,"ngStyle"],["name","time-outline"],[1,"secondary-text"],[4,"ngIf"],[1,"icon-text-container",2,"margin-left","10px"],["name","calendar-outline"]],template:function(e,t){1&e&&(n.Pb(0,"div",0),n.Xb("click",(function(e){return t.onItemClicked(e)})),n.Pb(1,"span",1),n.pc(2),n.Ob(),n.Pb(3,"div",2),n.nc(4,o,5,3,"span",3),n.Pb(5,"span",4),n.Lb(6,"ion-icon",5),n.Pb(7,"span",6),n.pc(8),n.ac(9,"date"),n.nc(10,r,3,4,"ng-container",7),n.Ob(),n.Ob(),n.Ob(),n.Ob()),2&e&&(n.fc("ngClass",t.bgCss),n.Ab(2),n.qc(t.headerText),n.Ab(2),n.fc("ngIf",null!=t.date),n.Ab(1),n.fc("ngStyle",n.hc(9,s,null!=t.date?"8%":"10px")),n.Ab(3),n.rc(" ",n.cc(9,6,t.fromTime,"shortTime")," "),n.Ab(2),n.fc("ngIf",t.untilTime))},directives:[c.i,c.k,c.l,a.s],pipes:[c.d],styles:[".item-container[_ngcontent-%COMP%]{height:50px;width:95%;border-radius:7px;display:flex;flex-direction:column;justify-content:space-evenly}.item-container[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]{margin-left:10px;font-size:1.2em}"]}),e}()},nLfy:function(e,t,i){"use strict";i.r(t),i.d(t,"SchedulePageModule",(function(){return W}));var n=i("ofXK"),c=i("3Pt+"),a=i("tyNb"),o=i("TEn/"),r=i("mrSG"),s=i("H7h6"),l=i("ShvM"),b=i("64sz"),d=i("PZfV"),u=i("fXoL"),f=i("2g2N"),g=i("F4Db"),h=i("xgIS"),m=i("wO+i"),p=["imageInput"];function v(e,t){if(1&e&&(u.Pb(0,"ion-title"),u.pc(1),u.Ob()),2&e){var i=u.Zb();u.Ab(1),u.qc(i.actionEditable.action.name)}}function A(e,t){1&e&&(u.Nb(0),u.Lb(1,"ion-icon",22),u.Mb())}function D(e,t){1&e&&(u.Nb(0),u.pc(1," None "),u.Mb())}function k(e,t){if(1&e&&(u.Pb(0,"ion-item",8),u.Pb(1,"ion-label"),u.pc(2,"Started"),u.Ob(),u.pc(3),u.ac(4,"date"),u.Ob()),2&e){var i=u.Zb(2);u.Ab(3),u.rc(" ",u.cc(4,1,i.actionEditable.actionStartedDateTime,"shortTime")," ")}}function C(e,t){if(1&e&&(u.Pb(0,"ion-item",8),u.Pb(1,"ion-label"),u.pc(2,"Finished"),u.Ob(),u.pc(3),u.ac(4,"date"),u.Ob()),2&e){var i=u.Zb(2);u.Ab(3),u.rc(" ",u.cc(4,1,i.actionEditable.actionFinishedDateTime,"shortTime")," ")}}function P(e,t){1&e&&(u.Nb(0),u.pc(1," Add picture "),u.Mb())}function O(e,t){1&e&&(u.Nb(0),u.pc(1," Change picture "),u.Mb())}function y(e,t){if(1&e&&u.Lb(0,"img",23),2&e){var i=u.Zb(2);u.fc("src",i.actionEditable.photo.pictureUri,u.lc)}}var x=function(e){return{completed:e}},T=function(e){return{canceled:e}};function w(e,t){if(1&e){var i=u.Qb();u.Pb(0,"ion-item-group"),u.Pb(1,"ion-item-divider",7),u.Pb(2,"h4"),u.pc(3,"General action description"),u.Ob(),u.Ob(),u.Pb(4,"ion-item",8),u.pc(5),u.Ob(),u.Pb(6,"ion-item-divider",9),u.Pb(7,"h4"),u.pc(8," Specific action info"),u.Ob(),u.nc(9,A,2,0,"ng-container",0),u.Ob(),u.Pb(10,"ion-item",8),u.Pb(11,"ion-label"),u.Pb(12,"h5"),u.pc(13,"Description"),u.Ob(),u.Pb(14,"p",10),u.nc(15,D,2,0,"ng-container",0),u.pc(16),u.Ob(),u.Ob(),u.Ob(),u.Pb(17,"ion-item",8),u.Pb(18,"ion-label"),u.pc(19,"Day"),u.Ob(),u.pc(20),u.Ob(),u.Pb(21,"ion-item",8),u.Pb(22,"ion-label"),u.pc(23,"Planned start time"),u.Ob(),u.pc(24),u.ac(25,"date"),u.Ob(),u.Pb(26,"ion-item",8),u.Pb(27,"ion-label"),u.pc(28,"Estimated duration"),u.Ob(),u.pc(29),u.Ob(),u.nc(30,k,5,4,"ion-item",11),u.nc(31,C,5,4,"ion-item",11),u.Pb(32,"ion-item",12),u.Pb(33,"ion-label"),u.pc(34,"Canceled"),u.Ob(),u.Pb(35,"ion-toggle",13),u.Xb("ngModelChange",(function(e){return u.kc(i),u.Zb().actionEditable.isCanceled=e}))("ionChange",(function(e){return u.kc(i),u.Zb().cancledChanged(e)})),u.Ob(),u.Ob(),u.Pb(36,"ion-item",8),u.Pb(37,"ion-label",14),u.pc(38,"Comment"),u.Ob(),u.Pb(39,"ion-textarea",15),u.Xb("ngModelChange",(function(e){return u.kc(i),u.Zb().actionEditable.comment=e})),u.Ob(),u.Ob(),u.Pb(40,"ion-item",3),u.Pb(41,"input",16,17),u.Xb("change",(function(e){return u.kc(i),u.Zb().processFile(e)})),u.Ob(),u.Pb(43,"ion-button",18),u.Xb("click",(function(){return u.kc(i),u.Zb().addPicture()})),u.Lb(44,"ion-icon",19),u.nc(45,P,2,0,"ng-container",0),u.nc(46,O,2,0,"ng-container",0),u.Ob(),u.Ob(),u.Pb(47,"div",20),u.nc(48,y,1,1,"img",21),u.Ob(),u.Ob()}if(2&e){var n=u.Zb();u.Ab(5),u.rc(" ",n.actionEditable.action.generalDescription," "),u.Ab(1),u.fc("ngClass",u.hc(20,x,n.actionEditable.isCompleted)),u.Ab(3),u.fc("ngIf",n.actionEditable.isCompleted),u.Ab(6),u.fc("ngIf",null==n.actionEditable.clientActionSpecificDescription),u.Ab(1),u.rc(" ",n.actionEditable.clientActionSpecificDescription," "),u.Ab(4),u.rc(" ",n.generalHelper.getDayNameByIndex(n.actionEditable.day)," "),u.Ab(4),u.rc(" ",u.cc(25,17,n.actionEditable.plannedStartDateTime,"shortTime")," "),u.Ab(5),u.rc(" ",n.actionEditable.estimatedDurationMinutes," min "),u.Ab(1),u.fc("ngIf",n.actionEditable.actionStartedDateTime),u.Ab(1),u.fc("ngIf",n.actionEditable.actionFinishedDateTime),u.Ab(1),u.fc("ngClass",u.hc(22,T,n.actionEditable.isCanceled)),u.Ab(3),u.fc("ngModel",n.actionEditable.isCanceled)("disabled",n.actionEditable.isCompleted),u.Ab(4),u.fc("ngModel",n.actionEditable.comment),u.Ab(6),u.fc("ngIf",!n.actionEditable.photo.pictureUri),u.Ab(1),u.fc("ngIf",n.actionEditable.photo.pictureUri),u.Ab(2),u.fc("ngIf",n.actionEditable.photo.pictureUri)}}function I(e,t){if(1&e){var i=u.Qb();u.Pb(0,"ion-button",24),u.Xb("click",(function(){return u.kc(i),u.Zb().startAction()})),u.pc(1," Start action "),u.Ob()}}function E(e,t){if(1&e){var i=u.Qb();u.Pb(0,"ion-button",25),u.Xb("click",(function(){return u.kc(i),u.Zb().stopAction()})),u.pc(1," Stop action "),u.Ob()}}function M(e,t){if(1&e&&(u.Nb(0),u.pc(1),u.Mb()),2&e){var i=u.Zb();u.Ab(1),u.rc(" ",i.time," ")}}var S,Z=((S=function(){function e(t,i,n,c,a,o){_classCallCheck(this,e),this.modalController=t,this.registeredActionsService=i,this.toaster=n,this.imageHelper=c,this.generalHelper=a,this.platform=o,this.time="00:00.000",this.started=null}return _createClass(e,[{key:"ngOnInit",value:function(){this.actionEditable=this.mapActionToEditable()}},{key:"updateAction",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.registeredActionsService.apiRegisteredActionsRegisteredActionPut(this.actionEditable);case 3:null!=(t=e.sent)&&(this.action=t,this.actionEditable=this.mapActionToEditable(),this.toaster.showSuccessToast("Successfully saved")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.toaster.showErrorToast("Opration failed. Try it again");case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"closeModal",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.dismiss();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"startAction",value:function(){this.actionEditable.actionStartedDateTime=new Date,this.startTimer(),this.updateAction()}},{key:"stopAction",value:function(){this.actionEditable.actionFinishedDateTime=new Date,this.isTimerVisible=!1,clearInterval(this.started),this.updateAction()}},{key:"addPicture",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==this.platform.is("capacitor")){e.next=2;break}return e.abrupt("return",void this.imageInput.nativeElement.click());case 2:return e.next=4,this.imageHelper.getImageAsBase64FromDevice();case 4:null!=(t=e.sent)&&(this.actionEditable.photo.pictureUri=t);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"processFile",value:function(e){var t=this,i=e.target.files,n=i[0];if(i&&n){var c=new FileReader;this.imageToBase64(c,n).subscribe((function(e){null!=e&&(t.actionEditable.photo.pictureUri=e)}))}}},{key:"imageToBase64",value:function(e,t){return e.readAsDataURL(t),Object(h.a)(e,"load").pipe(Object(m.a)("currentTarget","result"))}},{key:"mapActionToEditable",value:function(){var e={id:this.action.id,action:this.action.action,actionFinishedDateTime:this.action.actionFinishedDateTime,actionStartedDateTime:this.action.actionStartedDateTime,clientActionSpecificDescription:this.action.clientActionSpecificDescription,comment:this.action.comment,estimatedDurationMinutes:this.action.estimatedDurationMinutes,isCanceled:this.action.isCanceled,isCompleted:this.action.isCompleted,photo:this.action.photo,plannedStartDateTime:this.action.plannedStartDateTime,day:this.action.day};return!1===e.isCompleted&&!1===e.isCanceled&&null!=e.actionStartedDateTime&&this.startTimer(),e}},{key:"cancledChanged",value:function(e){e&&e.detail&&e.detail.checked&&!this.actionEditable.comment&&this.toaster.showInfoToast("Please enter reason why is action cancled to comment section.")}},{key:"startTimer",value:function(){this.started=setInterval(this.clockRunning.bind(this),10),this.isTimerVisible=!0}},{key:"clockRunning",value:function(){var e=this.actionEditable.actionStartedDateTime,t=new Date,i=new Date(t-e),n=i.getUTCHours(),c=i.getUTCMinutes(),a=i.getUTCSeconds(),o=i.getUTCMilliseconds();this.time=this.zeroPrefix(n,2)+":"+this.zeroPrefix(c,2)+":"+this.zeroPrefix(a,2)+"."+this.zeroPrefix(o,3)}},{key:"zeroPrefix",value:function(e,t){for(var i="",n=0;n<t;n++)i+="0";return(i+e).slice(-t)}}]),e}()).\u0275fac=function(e){return new(e||S)(u.Kb(o.P),u.Kb(s.e),u.Kb(f.a),u.Kb(g.a),u.Kb(b.a),u.Kb(o.R))},S.\u0275cmp=u.Eb({type:S,selectors:[["app-client-action-detail"]],viewQuery:function(e,t){var i;1&e&&u.tc(p,!0),2&e&&u.ic(i=u.Yb())&&(t.imageInput=i.first)},inputs:{action:"action"},decls:14,vars:6,consts:[[4,"ngIf"],["slot","end","fill","clear",3,"click"],["slot","icon-only","name","close"],["lines","none"],["slot","start","color","success",3,"click",4,"ngIf"],["slot","start","color","dark",3,"click",4,"ngIf"],["slot","end","color","primary",3,"disabled","click"],[1,"item-separator"],["lines","full","mode","md"],[1,"item-separator",3,"ngClass"],[2,"white-space","pre-wrap"],["lines","full","mode","md",4,"ngIf"],["lines","full","mode","md",3,"ngClass"],[3,"ngModel","disabled","ngModelChange","ionChange"],["position","floating"],["clearInput","","rows","5","autoGrow","",2,"min-height","100px",3,"ngModel","ngModelChange"],["type","file","hidden","","accept","image/*",3,"change"],["imageInput",""],["fill","clear","slot","end",3,"click"],["name","camera","slot","icon-only"],[2,"display","flex","justify-content","center"],["style","max-width: 70%;",3,"src",4,"ngIf"],["name","checkmark-circle-outline","slot","end"],[2,"max-width","70%",3,"src"],["slot","start","color","success",3,"click"],["slot","start","color","dark",3,"click"]],template:function(e,t){1&e&&(u.Pb(0,"ion-header"),u.Pb(1,"ion-toolbar"),u.nc(2,v,2,1,"ion-title",0),u.Pb(3,"ion-button",1),u.Xb("click",(function(){return t.closeModal()})),u.Lb(4,"ion-icon",2),u.Ob(),u.Ob(),u.Ob(),u.Pb(5,"ion-content"),u.nc(6,w,49,24,"ion-item-group",0),u.Ob(),u.Pb(7,"ion-footer"),u.Pb(8,"ion-item",3),u.nc(9,I,2,0,"ion-button",4),u.nc(10,E,2,0,"ion-button",5),u.nc(11,M,2,1,"ng-container",0),u.Pb(12,"ion-button",6),u.Xb("click",(function(){return t.updateAction()})),u.pc(13,"Save "),u.Ob(),u.Ob(),u.Ob()),2&e&&(u.Ab(2),u.fc("ngIf",t.actionEditable),u.Ab(4),u.fc("ngIf",t.actionEditable),u.Ab(3),u.fc("ngIf",!t.actionEditable.actionStartedDateTime),u.Ab(1),u.fc("ngIf",t.actionEditable.actionStartedDateTime&&!t.actionEditable.actionFinishedDateTime),u.Ab(1),u.fc("ngIf",t.isTimerVisible),u.Ab(1),u.fc("disabled",t.actionEditable.isCanceled&&null==t.actionEditable.comment))},directives:[o.r,o.L,n.k,o.i,o.s,o.n,o.p,o.w,o.J,o.y,o.x,n.i,o.z,o.K,o.c,c.c,c.d,o.I,o.V],pipes:[n.d],styles:[""]}),S),R=i("kUBF");function F(e,t){if(1&e){var i=u.Qb();u.Pb(0,"action-item-card",11),u.Xb("clicked",(function(){u.kc(i);var e=u.Zb().$implicit;return u.Zb(2).openDetailModal(e.id)})),u.Ob()}if(2&e){var n=u.Zb().$implicit,c=u.Zb(2);u.fc("headerText",n.action.name)("fromTime",n.plannedStartDateTime)("bgCss",c.visualHelper.getBgCssColorForRegisteredAction(n))}}function X(e,t){if(1&e&&(u.Pb(0,"div",9),u.nc(1,F,1,3,"action-item-card",10),u.Ob()),2&e){var i=t.index,n=u.Zb(2);u.Ab(1),u.fc("ngIf",i<3||n.allItemsVisible)}}function B(e,t){if(1&e){var i=u.Qb();u.Pb(0,"ion-button",12),u.Xb("click",(function(){return u.kc(i),u.Zb(2).showMore()})),u.pc(1,"Show more"),u.Ob()}}function L(e,t){if(1&e){var i=u.Qb();u.Pb(0,"ion-button",12),u.Xb("click",(function(){return u.kc(i),u.Zb(2).showLess()})),u.pc(1," Show less"),u.Ob()}}function N(e,t){if(1&e&&(u.Pb(0,"ion-card"),u.Pb(1,"div",1),u.Pb(2,"ion-avatar",2),u.Lb(3,"img",3),u.Ob(),u.Pb(4,"h3",4),u.pc(5),u.Ob(),u.Ob(),u.Pb(6,"div",5),u.nc(7,X,2,1,"div",6),u.Ob(),u.Pb(8,"div",7),u.nc(9,B,2,0,"ion-button",8),u.nc(10,L,2,0,"ion-button",8),u.Ob(),u.Ob()),2&e){var i=u.Zb();u.Ab(3),u.fc("src",i.client.profilePicture,u.lc),u.Ab(2),u.rc(" ",i.client.fullName," "),u.Ab(2),u.fc("ngForOf",i.clientActions.registeredActions),u.Ab(2),u.fc("ngIf",i.clientActions.registeredActions.length>3&&!1===i.allItemsVisible),u.Ab(1),u.fc("ngIf",i.clientActions.registeredActions.length>3&&i.allItemsVisible)}}var _,K=((_=function(){function e(t,i,n,c){_classCallCheck(this,e),this.clientCache=t,this.modalController=i,this.visualHelper=n,this.clientsService=c,this.detailModalClosed=new u.n,this.allItemsVisible=!1}return _createClass(e,[{key:"ngOnInit",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clientCache.loaded;case 2:if(t=this.clientActions.clientId,this.client=this.clientCache.getClientById(t),null!=this.client){e.next=11;break}return e.next=6,this.clientsService.apiClientsSingleClientGet(t);case 6:return i=e.sent,e.next=9,this.clientCache.mapDtoToClient(i);case 9:n=e.sent,this.client=n;case 11:case"end":return e.stop()}}),e,this)})))}},{key:"calculateEstimatedEndTime",value:function(e,t){return new Date(e.getTime()+6e4*t)}},{key:"openDetailModal",value:function(e){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,n,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.clientActions.registeredActions.find((function(t){return t.id===e})),t.next=3,this.modalController.create({component:Z,componentProps:{action:i}});case 3:return n=t.sent,t.next=6,n.present();case 6:n.onDidDismiss().then((function(){return c.detailModalClosed.emit()}));case 7:case"end":return t.stop()}}),t,this)})))}},{key:"showMore",value:function(){this.allItemsVisible=!0}},{key:"showLess",value:function(){this.allItemsVisible=!1}}]),e}()).\u0275fac=function(e){return new(e||_)(u.Kb(l.a),u.Kb(o.P),u.Kb(d.a),u.Kb(s.b))},_.\u0275cmp=u.Eb({type:_,selectors:[["client-actions-overview"]],inputs:{clientActions:"clientActions"},outputs:{detailModalClosed:"detailModalClosed"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"flex-row"],["slot","start",2,"margin","10px"],[3,"src"],[1,"client-name-header"],[1,"flex-column",2,"align-items","flex-end"],["class","action-item-small ",4,"ngFor","ngForOf"],[1,"flex-center"],["fill","clear",3,"click",4,"ngIf"],[1,"action-item-small"],[3,"headerText","fromTime","bgCss","clicked",4,"ngIf"],[3,"headerText","fromTime","bgCss","clicked"],["fill","clear",3,"click"]],template:function(e,t){1&e&&u.nc(0,N,11,5,"ion-card",0),2&e&&u.fc("ngIf",t.clientActions&&t.client)},directives:[n.k,o.k,o.e,n.j,R.a,o.i],styles:[".client-name-header[_ngcontent-%COMP%]{margin-left:10px;padding-top:10px}"]}),_);function j(e,t){if(1&e){var i=u.Qb();u.Pb(0,"ion-datetime",9,10),u.Xb("ngModelChange",(function(e){return u.kc(i),u.Zb().selectedDate=e}))("ionChange",(function(e){return u.kc(i),u.Zb().selectedDateChange(e)})),u.Ob()}if(2&e){var n=u.Zb();u.gc("min",n.ionDateTimeConsumableMinDate),u.gc("max",n.ionDateTimeConsumableMaxDate),u.fc("ngModel",n.selectedDate)}}function H(e,t){1&e&&(u.Pb(0,"p",11),u.pc(1,"No registered actions"),u.Ob())}function z(e,t){1&e&&(u.Nb(0),u.pc(1," (today) "),u.Mb())}function U(e,t){if(1&e){var i=u.Qb();u.Pb(0,"ion-col",15),u.Pb(1,"client-actions-overview",16),u.Xb("detailModalClosed",(function(){return u.kc(i),u.Zb(2).reloadData()})),u.Ob(),u.Ob()}if(2&e){var n=t.$implicit,c=u.Zb(2);u.fc("size",c.visualHelper.getBasicDataGridSize()),u.Ab(1),u.fc("clientActions",n)}}function Q(e,t){if(1&e&&(u.Nb(0),u.Pb(1,"ion-item-divider",12),u.Pb(2,"ion-label"),u.pc(3),u.ac(4,"date"),u.nc(5,z,2,0,"ng-container",13),u.Ob(),u.Ob(),u.Pb(6,"ion-grid"),u.Pb(7,"ion-row"),u.nc(8,U,2,2,"ion-col",14),u.Ob(),u.Ob(),u.Mb()),2&e){var i=t.$implicit,n=u.Zb();u.Ab(3),u.rc(" ",u.bc(4,3,i.date)," "),u.Ab(2),u.fc("ngIf",n.isToday(i.date)),u.Ab(3),u.fc("ngForOf",i.registeredActionsClient)}}function V(e,t){if(1&e){var i=u.Qb();u.Pb(0,"ion-infinite-scroll",17),u.Xb("ionInfinite",(function(e){return u.kc(i),u.Zb().loadMoreData(e)})),u.Lb(1,"ion-infinite-scroll-content",18),u.Ob()}}var G,Y,q=((G=function(){function e(t,i,n,c){_classCallCheck(this,e),this.registeredActionsService=t,this.clientsCache=i,this.generalHelper=n,this.visualHelper=c,this.isPreviousBtnEnabled=!0,this.isNextBtnEnabled=!0,this.selectedDate=(new Date).toISOString()}return _createClass(e,[{key:"ngOnInit",value:function(){this.reloadData()}},{key:"reloadData",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,n,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.registeredActionsService.apiRegisteredActionsLastRegisteredActionsMinMaxDateGet().then((function(e){c.minDate=e.minDate,c.maxDate=e.maxDate,c.ionDateTimeConsumableMinDate=c.convertDateToIonDateTimeConsumableString(c.minDate),c.ionDateTimeConsumableMaxDate=c.convertDateToIonDateTimeConsumableString(c.maxDate)})),e.next=3,this.clientsCache.loaded;case 3:return t=10,this.registeredActions&&0===this.registeredActions.length&&(t=this.registeredActions.length),this.registeredActions=null,i=new Date(this.selectedDate),e.next=8,this.registeredActionsService.apiRegisteredActionsRegisteredActionsGet(t,i,null);case 8:n=e.sent,this.registeredActions=n,console.log(n);case 10:case"end":return e.stop()}}),e,this)})))}},{key:"isToday",value:function(e){var t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}},{key:"loadMoreData",value:function(e){var t=this,i=this.registeredActions[this.registeredActions.length-1].date,n=this.registeredActions[this.registeredActions.length-1].registeredActionsClient,c=n[n.length-1].registeredActions,a=c[c.length-1],o=new Date(this.selectedDate);this.registeredActionsService.apiRegisteredActionsRegisteredActionsGet(10,o,a.id).then((function(c){t.generalHelper.compareDatesWithoutTime(i,c[0].date)&&n[n.length-1].clientId===c[0].registeredActionsClient[0].clientId&&(c=t.mergeData(c)),t.registeredActions=t.registeredActions.concat(c),e.target.disabled=t.registeredActions[t.registeredActions.length-1].containsLast})).finally((function(){return e.target.complete()}))}},{key:"mergeData",value:function(e){var t=this.registeredActions[this.registeredActions.length-1].registeredActionsClient;return this.registeredActions[this.registeredActions.length-1].registeredActionsClient[this.registeredActions[this.registeredActions.length-1].registeredActionsClient.length-1].registeredActions=t[t.length-1].registeredActions.concat(e[0].registeredActionsClient[0].registeredActions),e[0].registeredActionsClient.splice(0,1),0===e[0].registeredActionsClient.length&&e.splice(0,1),e}},{key:"previousDayClicked",value:function(){var e=new Date(this.selectedDate);e.setDate(e.getDate()-1),this.selectedDate=e.toISOString(),this.reloadData(),this.setPreviousDayBtnEnablity(e)}},{key:"nextDayClicked",value:function(){var e=new Date(this.selectedDate);e.setDate(e.getDate()+1),this.selectedDate=e.toISOString(),this.reloadData(),this.setNextDayBtnEnablity(e)}},{key:"setNextDayBtnEnablity",value:function(e){var t=new Date(this.maxDate);this.isNextBtnEnabled=!(e.setDate(e.getDate())>t.setHours(0,0,0,0))}},{key:"setPreviousDayBtnEnablity",value:function(e){var t=new Date(this.minDate);this.isPreviousBtnEnabled=!(e.setDate(e.getDate())<t.setHours(0,0,0,0))}},{key:"openDatePicker",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.datePicker.open();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"selectedDateChange",value:function(e){if(e&&e.detail&&e.detail.value){this.selectedDate=new Date(e.detail.value).toISOString(),this.reloadData();var t=new Date(this.selectedDate);this.setNextDayBtnEnablity(t),this.setPreviousDayBtnEnablity(t)}}},{key:"convertDateToIonDateTimeConsumableString",value:function(e){var t=e.getFullYear().toString(),i=(e.getMonth()+1).toString(),n=e.getDate().toString();return e.getMonth()+1<10&&(i="0".concat(i)),e.getDate()<10&&(n="0".concat(n)),"".concat(t,"-").concat(i,"-").concat(n)}}]),e}()).\u0275fac=function(e){return new(e||G)(u.Kb(s.e),u.Kb(l.a),u.Kb(b.a),u.Kb(d.a))},G.\u0275cmp=u.Eb({type:G,selectors:[["app-schedule"]],viewQuery:function(e,t){var i;1&e&&u.tc(o.o,!0),2&e&&u.ic(i=u.Yb())&&(t.datePicker=i.first)},decls:18,vars:9,consts:[[1,"flex-center"],["slot","icon-only","fill","clear",3,"disabled","click"],["name","arrow-back"],[1,"flex-align-center",2,"font-size","1.2em",3,"click"],["hidden","",3,"ngModel","min","max","ngModelChange","ionChange",4,"ngIf"],["name","arrow-forward"],["style","text-align: center;",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"ionInfinite",4,"ngIf"],["hidden","",3,"ngModel","min","max","ngModelChange","ionChange"],["datePicker",""],[2,"text-align","center"],[1,"item-separator"],[4,"ngIf"],[3,"size",4,"ngFor","ngForOf"],[3,"size"],[3,"clientActions","detailModalClosed"],[3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Loading more data..."]],template:function(e,t){1&e&&(u.Pb(0,"ion-header"),u.Pb(1,"ion-toolbar"),u.Pb(2,"ion-title"),u.pc(3,"Schedule"),u.Ob(),u.Ob(),u.Pb(4,"ion-toolbar"),u.Pb(5,"div",0),u.Pb(6,"ion-button",1),u.Xb("click",(function(){return t.previousDayClicked()})),u.Lb(7,"ion-icon",2),u.Ob(),u.Pb(8,"div",3),u.Xb("click",(function(){return t.openDatePicker()})),u.pc(9),u.ac(10,"date"),u.nc(11,j,2,3,"ion-datetime",4),u.Ob(),u.Pb(12,"ion-button",1),u.Xb("click",(function(){return t.nextDayClicked()})),u.Lb(13,"ion-icon",5),u.Ob(),u.Ob(),u.Ob(),u.Ob(),u.Pb(14,"ion-content"),u.nc(15,H,2,0,"p",6),u.nc(16,Q,9,5,"ng-container",7),u.nc(17,V,2,0,"ion-infinite-scroll",8),u.Ob()),2&e&&(u.Ab(6),u.fc("disabled",!t.isPreviousBtnEnabled),u.Ab(3),u.rc(" ",u.bc(10,7,t.selectedDate)," "),u.Ab(2),u.fc("ngIf",t.ionDateTimeConsumableMinDate&&t.ionDateTimeConsumableMaxDate),u.Ab(1),u.fc("disabled",!t.isNextBtnEnabled),u.Ab(3),u.fc("ngIf",t.registeredActions&&0==t.registeredActions.length),u.Ab(1),u.fc("ngForOf",t.registeredActions),u.Ab(1),u.fc("ngIf",t.registeredActions))},directives:[o.r,o.L,o.J,o.i,o.s,n.k,o.n,n.j,o.o,o.U,c.c,c.d,o.x,o.z,o.q,o.D,o.m,K,o.t,o.u],pipes:[n.d],styles:[""]}),G),J=i("hcQm"),$=[{path:"",component:q}],W=((Y=function e(){_classCallCheck(this,e)}).\u0275mod=u.Ib({type:Y}),Y.\u0275inj=u.Hb({factory:function(e){return new(e||Y)},imports:[[n.b,c.a,o.M,J.a,a.j.forChild($)]]}),Y)}}]);